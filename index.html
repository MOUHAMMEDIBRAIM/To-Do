<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova Glass | Ultimate Task Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        /* ====== CORE STYLES ====== */
        :root {
            /* Glassmorphic Colors */
            --glass-bg: rgba(255, 255, 255, 0.2);
            --glass-border: rgba(255, 255, 255, 0.3);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --glass-blur: blur(16px);
            --glass-highlight: rgba(255, 255, 255, 0.1);
            
            /* Light Mode */
            --light-bg: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --light-text: #2d3748;
            --light-card: var(--glass-bg);
            --light-border: var(--glass-border);
            --light-primary: #6d28d9;
            --light-accent: #7c3aed;
            --light-danger: #dc2626;
            --light-warning: #d97706;
            --light-success: #059669;
            --light-category: rgba(155, 89, 182, 0.25);
            --light-location: rgba(52, 144, 220, 0.25);
            --light-note: rgba(234, 179, 8, 0.25);
            
            /* Dark Mode */
            --dark-bg: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            --dark-text: #e2e8f0;
            --dark-card: rgba(30, 41, 59, 0.6);
            --dark-border: rgba(255, 255, 255, 0.15);
            --dark-primary: #8b5cf6;
            --dark-accent: #a78bfa;
            --dark-danger: #f87171;
            --dark-warning: #fbbf24;
            --dark-success: #34d399;
            --dark-category: rgba(155, 89, 182, 0.35);
            --dark-location: rgba(96, 165, 250, 0.35);
            --dark-note: rgba(234, 179, 8, 0.35);
            
            /* Active Theme */
            --bg: var(--light-bg);
            --text: var(--light-text);
            --card: var(--light-card);
            --border: var(--light-border);
            --primary: var(--light-primary);
            --accent: var(--light-accent);
            --danger: var(--light-danger);
            --warning: var(--light-warning);
            --success: var(--light-success);
            --category: var(--light-category);
            --location: var(--light-location);
            --note: var(--light-note);

            /* Glass Effect Variables */
            --blur-intensity: 16px;
            --glow-intensity: 0.2;
        }

        /* Auto Dark Mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: var(--dark-bg);
                --text: var(--dark-text);
                --card: var(--dark-card);
                --border: var(--dark-border);
                --primary: var(--dark-primary);
                --accent: var(--dark-accent);
                --danger: var(--dark-danger);
                --warning: var(--dark-warning);
                --success: var(--dark-success);
                --category: var(--dark-category);
                --location: var(--dark-location);
                --note: var(--dark-note);
            }
        }

        [data-theme="light"] {
            --bg: var(--light-bg);
            --text: var(--light-text);
            --card: var(--light-card);
            --border: var(--light-border);
            --primary: var(--light-primary);
            --accent: var(--light-accent);
            --danger: var(--light-danger);
            --warning: var(--light-warning);
            --success: var(--light-success);
            --category: var(--light-category);
            --location: var(--light-location);
            --note: var(--light-note);
        }

        [data-theme="dark"] {
            --bg: var(--dark-bg);
            --text: var(--dark-text);
            --card: var(--dark-card);
            --border: var(--dark-border);
            --primary: var(--dark-primary);
            --accent: var(--dark-accent);
            --danger: var(--dark-danger);
            --warning: var(--dark-warning);
            --success: var(--dark-success);
            --category: var(--dark-category);
            --location: var(--dark-location);
            --note: var(--dark-note);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: 
                background-color 0.5s ease, 
                color 0.3s ease, 
                border-color 0.3s ease,
                transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275),
                opacity 0.3s ease,
                backdrop-filter 0.5s ease,
                box-shadow 0.3s ease;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.5;
            background-attachment: fixed;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Mobile Warning */
        .mobile-warning {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg);
            z-index: 1000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
        }

        .mobile-warning-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            color: var(--danger);
        }

        .mobile-warning h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .mobile-warning p {
            font-size: 1rem;
            margin-bottom: 2rem;
            color: var(--text);
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .mobile-warning {
                display: flex;
            }
            .container {
                display: none;
            }
        }

        /* ====== HEADER ====== */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            animation: fadeIn 0.5s ease-out;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.5rem;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            padding: 0.75rem 1.5rem;
            border-radius: 16px;
            border: 1px solid var(--border);
            box-shadow: var(--glass-shadow);
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            animation: pulse 2s infinite alternate;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
        }

        .header-btn {
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            box-shadow: var(--glass-shadow);
            cursor: pointer;
            color: var(--text);
            opacity: 0.9;
            padding: 0.75rem;
            border-radius: 12px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
        }

        .header-btn:hover {
            opacity: 1;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .header-btn.theme-toggle {
            position: relative;
            overflow: hidden;
        }

        .theme-icon {
            position: absolute;
            transition: all 0.3s ease;
        }

        .theme-icon.sun {
            opacity: var(--light-theme-icon-opacity, 1);
            transform: var(--light-theme-icon-transform, scale(1));
        }

        .theme-icon.moon {
            opacity: var(--dark-theme-icon-opacity, 0);
            transform: var(--dark-theme-icon-transform, scale(0.5));
        }

        /* ====== SEARCH & FILTER ====== */
        .search-container {
            margin-bottom: 1.5rem;
            animation: slideUp 0.4s ease-out;
        }

        .search-input {
            width: 100%;
            padding: 1rem 1.5rem;
            border: 1px solid var(--border);
            border-radius: 16px;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            font-size: 1rem;
            color: var(--text);
            box-shadow: var(--glass-shadow);
            transition: all 0.3s;
            margin-bottom: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(109, 40, 217, 0.2);
            transform: translateY(-2px);
        }

        .filter-container {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.75rem 1.25rem;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            color: var(--text);
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 80px;
            text-align: center;
            box-shadow: var(--glass-shadow);
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(109, 40, 217, 0.25);
        }

        .priority-filter {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .priority-btn {
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 12px;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.8rem;
            flex: 1;
            min-width: 80px;
            text-align: center;
            box-shadow: var(--glass-shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .priority-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .priority-btn.active {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .priority-btn.low {
            border-color: var(--success);
            color: var(--success);
        }

        .priority-btn.medium {
            border-color: var(--warning);
            color: var(--warning);
        }

        .priority-btn.high {
            border-color: var(--danger);
            color: var(--danger);
        }

        /* ====== MAIN BUTTON ====== */
        .main-add-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 8px 24px rgba(109, 40, 217, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }

        .main-add-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 12px 32px rgba(109, 40, 217, 0.4);
            animation: pulse 1s infinite alternate;
        }

        /* ====== TASK LIST ====== */
        .task-list {
            list-style: none;
            margin-bottom: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .task-item {
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            align-items: flex-start;
            gap: 1.25rem;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: fadeIn 0.5s ease-out;
            position: relative;
            box-shadow: var(--glass-shadow);
        }

        .task-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
        }

        .task-item.pinned {
            border-left: 4px solid var(--primary);
            background: rgba(109, 40, 217, 0.1);
        }

        .task-item.completed {
            opacity: 0.7;
            background: rgba(5, 150, 105, 0.1);
        }

        .task-item.completed .task-text {
            text-decoration: line-through;
        }

        .task-checkbox {
            width: 22px;
            height: 22px;
            accent-color: var(--primary);
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 3px;
        }

        .task-checkbox:hover {
            transform: scale(1.2);
        }

        .task-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .task-text {
            font-size: 1.1rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .task-description {
            font-size: 0.9rem;
            color: var(--text);
            opacity: 0.8;
            line-height: 1.5;
            margin-top: 0.25rem;
        }

        .task-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--text);
            opacity: 0.8;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .task-date {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: var(--glass-blur);
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
        }

        .task-priority {
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .priority-low {
            background-color: rgba(5, 150, 105, 0.2);
            color: var(--success);
        }

        .priority-medium {
            background-color: rgba(217, 119, 6, 0.2);
            color: var(--warning);
        }

        .priority-high {
            background-color: rgba(220, 38, 38, 0.2);
            color: var(--danger);
        }

        .task-category {
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            background-color: var(--category);
            color: #9b59b6;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .task-location {
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            background-color: var(--location);
            color: #3b82f6;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .task-note {
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            background-color: var(--note);
            color: #ca8a04;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
            margin-left: auto;
        }

        .task-btn {
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: var(--glass-blur);
            border: none;
            cursor: pointer;
            color: var(--text);
            opacity: 0.8;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            transition: all 0.3s;
            box-shadow: var(--glass-shadow);
        }

        .task-btn:hover {
            opacity: 1;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .task-btn.delete {
            color: var(--danger);
        }

        .task-btn.edit {
            color: var(--accent);
        }

        .task-btn.pin {
            color: var(--warning);
        }

        .task-btn.note {
            color: #ca8a04;
        }

        /* ====== STATS ====== */
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: var(--text);
            opacity: 0.8;
            animation: slideUp 0.4s ease-out 0.2s both;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1rem 1.5rem;
            box-shadow: var(--glass-shadow);
        }

        .clear-completed {
            color: var(--danger);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .clear-completed:hover {
            opacity: 1;
            text-decoration: underline;
        }

        /* ====== FLOATING ADD WINDOW ====== */
        .add-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 600px;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.2);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .add-window.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .add-window-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .add-window-title {
            font-size: 1.5rem;
            font-weight: 600;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .close-add-window {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: var(--text);
            opacity: 0.7;
            transition: all 0.3s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-add-window:hover {
            opacity: 1;
            transform: rotate(90deg);
            background: rgba(0, 0, 0, 0.1);
        }

        .add-form-group {
            margin-bottom: 1.5rem;
        }

        .add-form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
            font-size: 1rem;
        }

        .add-form-group input,
        .add-form-group textarea,
        .add-form-group select {
            width: 100%;
            padding: 1rem;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            color: var(--text);
            transition: all 0.3s;
            box-shadow: var(--glass-shadow);
        }

        .add-form-group input:focus,
        .add-form-group textarea:focus,
        .add-form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(109, 40, 217, 0.2);
            transform: translateY(-2px);
        }

        .add-form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .add-form-row {
            display: flex;
            gap: 1.5rem;
        }

        .add-form-row .add-form-group {
            flex: 1;
        }

        /* Priority Radio Buttons */
        .priority-options {
            display: flex;
            gap: 0.75rem;
            margin-top: 0.5rem;
        }

        .priority-option {
            flex: 1;
        }

        .priority-option input {
            display: none;
        }

        .priority-label {
            display: block;
            padding: 0.75rem;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
        }

        .priority-option input:checked + .priority-label {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(109, 40, 217, 0.2);
        }

        .priority-label.low {
            border-color: var(--success);
            color: var(--success);
        }

        .priority-label.medium {
            border-color: var(--warning);
            color: var(--warning);
        }

        .priority-label.high {
            border-color: var(--danger);
            color: var(--danger);
        }

        .priority-option input:checked + .priority-label.low {
            background: var(--success);
            border-color: var(--success);
        }

        .priority-option input:checked + .priority-label.medium {
            background: var(--warning);
            border-color: var(--warning);
        }

        .priority-option input:checked + .priority-label.high {
            background: var(--danger);
            border-color: var(--danger);
        }

        .category-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 0.75rem;
        }

        .category-btn {
            flex: 1;
            padding: 0.75rem;
            border-radius: 10px;
            border: none;
            background: rgba(0, 0, 0, 0.1);
            color: var(--text);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .category-btn:hover {
            background: var(--primary);
            color: white;
        }

        .add-form-submit {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(109, 40, 217, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .add-form-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(109, 40, 217, 0.3);
        }

        /* ====== EDIT WINDOW ====== */
        .edit-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.2);
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .edit-window.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .edit-window-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .edit-window-title {
            font-size: 1.5rem;
            font-weight: 600;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .close-edit-window {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: var(--text);
            opacity: 0.7;
            transition: all 0.3s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-edit-window:hover {
            opacity: 1;
            transform: rotate(90deg);
            background: rgba(0, 0, 0, 0.1);
        }

        .edit-form-group {
            margin-bottom: 1.5rem;
        }

        .edit-form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
            font-size: 1rem;
        }

        .edit-form-group input,
        .edit-form-group textarea,
        .edit-form-group select {
            width: 100%;
            padding: 1rem;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            color: var(--text);
            transition: all 0.3s;
            box-shadow: var(--glass-shadow);
        }

        .edit-form-group input:focus,
        .edit-form-group textarea:focus,
        .edit-form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(109, 40, 217, 0.2);
            transform: translateY(-2px);
        }

        .edit-form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Edit Priority Radio Buttons */
        .edit-priority-options {
            display: flex;
            gap: 0.75rem;
            margin-top: 0.5rem;
        }

        .edit-priority-option {
            flex: 1;
        }

        .edit-priority-option input {
            display: none;
        }

        .edit-priority-label {
            display: block;
            padding: 0.75rem;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
        }

        .edit-priority-option input:checked + .edit-priority-label {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(109, 40, 217, 0.2);
        }

        .edit-priority-label.low {
            border-color: var(--success);
            color: var(--success);
        }

        .edit-priority-label.medium {
            border-color: var(--warning);
            color: var(--warning);
        }

        .edit-priority-label.high {
            border-color: var(--danger);
            color: var(--danger);
        }

        .edit-priority-option input:checked + .edit-priority-label.low {
            background: var(--success);
            border-color: var(--success);
        }

        .edit-priority-option input:checked + .edit-priority-label.medium {
            background: var(--warning);
            border-color: var(--warning);
        }

        .edit-priority-option input:checked + .edit-priority-label.high {
            background: var(--danger);
            border-color: var(--danger);
        }

        .edit-form-row {
            display: flex;
            gap: 1.5rem;
        }

        .edit-form-row .edit-form-group {
            flex: 1;
        }

        .edit-form-submit {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(109, 40, 217, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .edit-form-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(109, 40, 217, 0.3);
        }

        /* ====== NOTE WINDOW ====== */
        .note-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.2);
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .note-window.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .note-window-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .note-window-title {
            font-size: 1.5rem;
            font-weight: 600;
            background: linear-gradient(90deg, #ca8a04, #eab308);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .close-note-window {
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: var(--text);
            opacity: 0.7;
            transition: all 0.3s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-note-window:hover {
            opacity: 1;
            transform: rotate(90deg);
            background: rgba(0, 0, 0, 0.1);
        }

        .note-content {
            min-height: 200px;
            width: 100%;
            padding: 1.5rem;
            border: 1px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            color: var(--text);
            transition: all 0.3s;
            box-shadow: var(--glass-shadow);
            margin-bottom: 1.5rem;
        }

        .note-content:focus {
            outline: none;
            border-color: #eab308;
            box-shadow: 0 0 0 3px rgba(234, 179, 8, 0.2);
            transform: translateY(-2px);
        }

        .note-form-submit {
            background: linear-gradient(135deg, #ca8a04, #eab308);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(234, 179, 8, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .note-form-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(234, 179, 8, 0.3);
        }

        /* ====== NOTIFICATION SYSTEM ====== */
        .notification-container {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            width: 350px;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            z-index: 1000;
            pointer-events: none;
        }

        .notification {
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            color: var(--text);
            padding: 1rem 1.25rem;
            border-radius: 14px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: translateX(100%);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            border: 1px solid var(--border);
            pointer-events: auto;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1rem;
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .notification.success .notification-icon {
            background: rgba(5, 150, 105, 0.2);
            color: var(--success);
        }

        .notification.error {
            border-left: 4px solid var(--danger);
        }

        .notification.error .notification-icon {
            background: rgba(220, 38, 38, 0.2);
            color: var(--danger);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        .notification.warning .notification-icon {
            background: rgba(217, 119, 6, 0.2);
            color: var(--warning);
        }

        .notification.info {
            border-left: 4px solid var(--accent);
        }

        .notification.info .notification-icon {
            background: rgba(124, 58, 237, 0.2);
            color: var(--accent);
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }

        .notification-message {
            font-size: 0.85rem;
            opacity: 0.8;
            line-height: 1.4;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text);
            opacity: 0.5;
            cursor: pointer;
            transition: all 0.3s;
            align-self: flex-start;
        }

        .notification-close:hover {
            opacity: 1;
            transform: rotate(90deg);
        }

        /* ====== SETTINGS PANEL ====== */
        .settings-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.2);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow-y: auto;
        }

        .settings-panel.active {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            animation: fadeIn 0.5s ease-out;
        }

        .settings-title {
            font-size: 1.5rem;
            font-weight: 600;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .close-settings {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text);
            transition: transform 0.3s;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-settings:hover {
            transform: rotate(90deg);
            background: rgba(0, 0, 0, 0.1);
        }

        .settings-group {
            margin-bottom: 2rem;
            animation: fadeIn 0.5s ease-out;
        }

        .settings-label {
            display: block;
            margin-bottom: 1rem;
            font-weight: 500;
            font-size: 1rem;
        }

        .theme-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .theme-option {
            flex: 1;
            padding: 1.5rem 1rem;
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            box-shadow: var(--glass-shadow);
        }

        .theme-option:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .theme-option.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--primary);
            background-color: rgba(109, 40, 217, 0.1);
            transform: translateY(-3px);
        }

        .theme-icon-large {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        /* Glass Effect Controls */
        .glass-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .glass-control {
            flex: 1;
        }

        .glass-control label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text);
            opacity: 0.8;
        }

        .glass-slider {
            width: 100%;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.1);
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }

        .glass-slider:hover {
            opacity: 1;
        }

        .glass-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }

        .glass-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }

        /* Custom Switch */
        .toggle-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            border-radius: 12px;
            box-shadow: var(--glass-shadow);
            transition: all 0.3s;
        }

        .toggle-group:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .toggle-label {
            font-size: 0.95rem;
            font-weight: 500;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(24px);
            background-color: white;
        }

        /* Color Options */
        .color-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .color-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }

        .color-option input {
            position: absolute;
            opacity: 0;
        }

        .color-box {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .color-option input:checked + .color-box {
            border-color: var(--text);
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .color-name {
            font-size: 0.8rem;
            color: var(--text);
            opacity: 0.8;
        }

        .purple {
            background: linear-gradient(135deg, #6d28d9, #7c3aed);
        }

        .blue {
            background: linear-gradient(135deg, #2563eb, #3b82f6);
        }

        .green {
            background: linear-gradient(135deg, #059669, #10b981);
        }

        .red {
            background: linear-gradient(135deg, #dc2626, #ef4444);
        }

        .pink {
            background: linear-gradient(135deg, #db2777, #ec4899);
        }

        .orange {
            background: linear-gradient(135deg, #ea580c, #f97316);
        }

        /* Data Buttons */
        .data-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            cursor: pointer;
            width: 100%;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            transition: all 0.3s;
            box-shadow: var(--glass-shadow);
        }

        .data-btn:hover {
            background: rgba(0, 0, 0, 0.1);
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        #file-input {
            display: none;
        }

        /* ====== OVERLAY ====== */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 90;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* ====== ANIMATIONS ====== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateX(20px);
            }
            to { 
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Task Animation Effect */
        .task-animation {
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .task-animation:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        /* ====== EMPTY STATE ====== */
        .empty-state {
            text-align: center;
            padding: 3rem 0;
            color: var(--text);
            opacity: 0.5;
            animation: fadeIn 0.5s ease-out;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            box-shadow: var(--glass-shadow);
            margin-top: 1rem;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.7;
        }

        /* ====== DATE PICKER STYLES ====== */
        .date-picker {
            position: relative;
            display: flex;
        }

        .date-input {
            flex: 1;
            padding: 0.875rem 1rem;
            border: 1px solid var(--border);
            border-radius: 12px 0 0 12px;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            color: var(--text);
            cursor: pointer;
            box-shadow: var(--glass-shadow);
        }

        .date-picker-btn {
            width: 44px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-left: none;
            border-radius: 0 12px 12px 0;
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .date-picker-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .calendar-popup {
            position: absolute;
            top: 100%;
            left: 0;
            width: 280px;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1rem;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .calendar-popup.show {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0);
        }

        .calendar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .calendar-month-year {
            font-weight: 600;
        }

        .calendar-nav {
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            font-size: 1rem;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .calendar-nav:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.8rem;
            text-align: center;
            color: var(--text);
            opacity: 0.7;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }

        .calendar-day {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 32px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .calendar-day:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .calendar-day.today {
            background: var(--primary);
            color: white;
        }

        .calendar-day.selected {
            background: var(--accent);
            color: white;
        }

        .calendar-day.other-month {
            opacity: 0.4;
        }

        .calendar-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
        }

        .calendar-today-btn,
        .calendar-clear-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }

        .calendar-today-btn {
            background: var(--primary);
            color: white;
        }

        .calendar-today-btn:hover {
            background: var(--accent);
        }

        .calendar-clear-btn {
            background: rgba(0, 0, 0, 0.1);
            color: var(--text);
        }

        .calendar-clear-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        /* ====== CONFIRMATION DIALOG ====== */
        .confirmation-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 400px;
            background: var(--card);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.2);
            z-index: 300;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .confirmation-dialog.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .confirmation-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .confirmation-message {
            font-size: 1rem;
            margin-bottom: 2rem;
            color: var(--text);
            opacity: 0.8;
        }

        .confirmation-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .confirmation-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .confirmation-btn.cancel {
            background: rgba(0, 0, 0, 0.1);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .confirmation-btn.cancel:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .confirmation-btn.confirm {
            background: var(--danger);
            color: white;
            border: none;
        }

        .confirmation-btn.confirm:hover {
            background: #b91c1c;
            transform: translateY(-2px);
        }

        /* ====== RESPONSIVE DESIGN ====== */
        @media (max-width: 768px) {
            .container {
                padding: 1.5rem 1rem;
            }

            .add-window {
                width: calc(100% - 2rem);
                padding: 1.5rem;
            }

            .main-add-btn {
                bottom: 1.5rem;
                right: 1.5rem;
            }

            .settings-panel {
                width: calc(100% - 2rem);
                padding: 1.5rem;
            }

            .edit-window, .note-window {
                width: calc(100% - 2rem);
                padding: 1.5rem;
            }

            .task-item {
                flex-direction: column;
                gap: 1rem;
            }

            .task-actions {
                margin-left: 0;
                width: 100%;
                justify-content: flex-end;
            }

            .notification-container {
                width: calc(100% - 2rem);
                right: 1rem;
            }

            .color-options {
                grid-template-columns: repeat(2, 1fr);
            }

            .calendar-popup {
                width: 100%;
                left: 0;
            }

            .priority-options, .edit-priority-options {
                flex-direction: column;
            }

            .add-form-row, .edit-form-row {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Warning -->
    <div class="mobile-warning">
        <div class="mobile-warning-icon">📱</div>
        <h2>Mobile Not Supported</h2>
        <p>Please use Nova Glass on a larger screen for the best experience.</p>
        <p>We recommend using a desktop or tablet device.</p>
    </div>

    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-layer-group"></i></div>
                <span>Nova Glass</span>
            </div>
            <div class="header-actions">
                <button class="header-btn theme-toggle" id="themeToggle">
                    <i class="fas fa-sun theme-icon sun"></i>
                    <i class="fas fa-moon theme-icon moon"></i>
                </button>
                <button class="header-btn" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </header>

        <!-- Search Box -->
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="Search tasks...">
            <div class="filter-container">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="active">Active</button>
                <button class="filter-btn" data-filter="completed">Completed</button>
                <button class="filter-btn" data-filter="pinned">Pinned</button>
                <button class="filter-btn" data-filter="today">Today</button>
                <button class="filter-btn" data-filter="upcoming">Upcoming</button>
            </div>
            <div class="priority-filter">
                <button class="priority-btn active" data-priority="all">All</button>
                <button class="priority-btn low" data-priority="low">
                    <i class="fas fa-battery-quarter"></i> Low
                </button>
                <button class="priority-btn medium" data-priority="medium">
                    <i class="fas fa-battery-half"></i> Medium
                </button>
                <button class="priority-btn high" data-priority="high">
                    <i class="fas fa-battery-full"></i> High
                </button>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats">
            <span id="statsText">0 tasks (0 completed)</span>
            <span class="clear-completed" id="clearCompleted">
                <i class="fas fa-trash"></i> Clear Completed
            </span>
        </div>

        <!-- Task List -->
        <ul class="task-list" id="taskList">
            <!-- Tasks will be added here dynamically -->
        </ul>
    </div>

    <!-- Floating Add Button -->
    <button class="main-add-btn" id="mainAddBtn">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Floating Add Window -->
    <div class="add-window" id="addWindow">
        <div class="add-window-header">
            <h3 class="add-window-title">Add New Task</h3>
            <button class="close-add-window" id="closeAddWindow">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <form id="addTaskForm">
            <div class="add-form-group">
                <label for="addTaskTitle">Task Title</label>
                <input type="text" id="addTaskTitle" required>
            </div>
            <div class="add-form-group">
                <label for="addTaskDescription">Description (Optional)</label>
                <textarea id="addTaskDescription"></textarea>
            </div>
            <div class="add-form-row">
                <div class="add-form-group">
                    <label>Priority</label>
                    <div class="priority-options">
                        <div class="priority-option">
                            <input type="radio" id="addPriorityLow" name="addTaskPriority" value="low">
                            <label for="addPriorityLow" class="priority-label low">Low</label>
                        </div>
                        <div class="priority-option">
                            <input type="radio" id="addPriorityMedium" name="addTaskPriority" value="medium" checked>
                            <label for="addPriorityMedium" class="priority-label medium">Medium</label>
                        </div>
                        <div class="priority-option">
                            <input type="radio" id="addPriorityHigh" name="addTaskPriority" value="high">
                            <label for="addPriorityHigh" class="priority-label high">High</label>
                        </div>
                    </div>
                </div>
                <div class="add-form-group">
                    <label for="addTaskDue">Due Date</label>
                    <div class="date-picker">
                        <input type="text" id="addTaskDue" class="date-input" readonly>
                        <button type="button" class="date-picker-btn" id="datePickerBtn">
                            <i class="far fa-calendar-alt"></i>
                        </button>
                        <div class="calendar-popup" id="calendarPopup">
                            <div class="calendar-header">
                                <button type="button" class="calendar-nav prev-month">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <span class="calendar-month-year"></span>
                                <button type="button" class="calendar-nav next-month">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            <div class="calendar-weekdays">
                                <div>Sun</div>
                                <div>Mon</div>
                                <div>Tue</div>
                                <div>Wed</div>
                                <div>Thu</div>
                                <div>Fri</div>
                                <div>Sat</div>
                            </div>
                            <div class="calendar-days" id="calendarDays"></div>
                            <div class="calendar-footer">
                                <button type="button" class="calendar-today-btn">Today</button>
                                <button type="button" class="calendar-clear-btn">Clear</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="add-form-row">
                <div class="add-form-group">
                    <label for="addTaskCategory">Category</label>
                    <select id="addTaskCategory">
                        <!-- Categories will be populated dynamically -->
                    </select>
                    <div class="category-actions">
                        <button type="button" class="category-btn" id="addCategoryBtn">
                            <i class="fas fa-plus"></i> Add
                        </button>
                        <button type="button" class="category-btn" id="removeCategoryBtn">
                            <i class="fas fa-minus"></i> Remove
                        </button>
                    </div>
                </div>
                <div class="add-form-group">
                    <label for="addTaskLocation">Location (Optional)</label>
                    <input type="text" id="addTaskLocation" placeholder="e.g. Home, Office">
                </div>
            </div>
            <button type="submit" class="add-form-submit">
                <i class="fas fa-plus"></i> Add Task
            </button>
        </form>
    </div>

    <!-- Edit Window -->
    <div class="edit-window" id="editWindow">
        <div class="edit-window-header">
            <h3 class="edit-window-title">Edit Task</h3>
            <button class="close-edit-window" id="closeEditWindow">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <form id="editTaskForm">
            <input type="hidden" id="editTaskId">
            <div class="edit-form-group">
                <label for="editTaskTitle">Task Title</label>
                <input type="text" id="editTaskTitle" required>
            </div>
            <div class="edit-form-group">
                <label for="editTaskDescription">Description (Optional)</label>
                <textarea id="editTaskDescription"></textarea>
            </div>
            <div class="edit-form-row">
                <div class="edit-form-group">
                    <label>Priority</label>
                    <div class="edit-priority-options">
                        <div class="edit-priority-option">
                            <input type="radio" id="editPriorityLow" name="editTaskPriority" value="low">
                            <label for="editPriorityLow" class="edit-priority-label low">Low</label>
                        </div>
                        <div class="edit-priority-option">
                            <input type="radio" id="editPriorityMedium" name="editTaskPriority" value="medium">
                            <label for="editPriorityMedium" class="edit-priority-label medium">Medium</label>
                        </div>
                        <div class="edit-priority-option">
                            <input type="radio" id="editPriorityHigh" name="editTaskPriority" value="high">
                            <label for="editPriorityHigh" class="edit-priority-label high">High</label>
                        </div>
                    </div>
                </div>
                <div class="edit-form-group">
                    <label for="editTaskDue">Due Date</label>
                    <div class="date-picker">
                        <input type="text" id="editTaskDue" class="date-input" readonly>
                        <button type="button" class="date-picker-btn" id="editDatePickerBtn">
                            <i class="far fa-calendar-alt"></i>
                        </button>
                        <div class="calendar-popup" id="editCalendarPopup">
                            <div class="calendar-header">
                                <button type="button" class="calendar-nav prev-month">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <span class="calendar-month-year"></span>
                                <button type="button" class="calendar-nav next-month">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            <div class="calendar-weekdays">
                                <div>Sun</div>
                                <div>Mon</div>
                                <div>Tue</div>
                                <div>Wed</div>
                                <div>Thu</div>
                                <div>Fri</div>
                                <div>Sat</div>
                            </div>
                            <div class="calendar-days" id="editCalendarDays"></div>
                            <div class="calendar-footer">
                                <button type="button" class="calendar-today-btn">Today</button>
                                <button type="button" class="calendar-clear-btn">Clear</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="edit-form-row">
                <div class="edit-form-group">
                    <label for="editTaskCategory">Category</label>
                    <select id="editTaskCategory">
                        <!-- Categories will be populated dynamically -->
                    </select>
                </div>
                <div class="edit-form-group">
                    <label for="editTaskLocation">Location (Optional)</label>
                    <input type="text" id="editTaskLocation" placeholder="e.g. Home, Office">
                </div>
            </div>
            <button type="submit" class="edit-form-submit">
                <i class="fas fa-save"></i> Save Changes
            </button>
        </form>
    </div>

    <!-- Note Window -->
    <div class="note-window" id="noteWindow">
        <div class="note-window-header">
            <h3 class="note-window-title">Task Notes</h3>
            <button class="close-note-window" id="closeNoteWindow">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <form id="noteForm">
            <input type="hidden" id="noteTaskId">
            <textarea class="note-content" id="noteContent" placeholder="Add your notes here..."></textarea>
            <button type="submit" class="note-form-submit">
                <i class="fas fa-save"></i> Save Notes
            </button>
        </form>
    </div>

    <!-- Confirmation Dialog -->
    <div class="confirmation-dialog" id="confirmationDialog">
        <h3 class="confirmation-title" id="confirmationTitle">Confirm Action</h3>
        <p class="confirmation-message" id="confirmationMessage">Are you sure you want to perform this action?</p>
        <div class="confirmation-buttons">
            <button class="confirmation-btn cancel" id="confirmationCancel">Cancel</button>
            <button class="confirmation-btn confirm" id="confirmationConfirm">Confirm</button>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h2 class="settings-title">Settings</h2>
            <button class="close-settings" id="closeSettings">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="settings-group">
            <label class="settings-label">Appearance</label>
            <div class="theme-selector">
                <div class="theme-option active" data-theme="system">
                    <div class="theme-icon-large">💻</div>
                    <div>System</div>
                </div>
                <div class="theme-option" data-theme="light">
                    <div class="theme-icon-large">☀️</div>
                    <div>Light</div>
                </div>
                <div class="theme-option" data-theme="dark">
                    <div class="theme-icon-large">🌙</div>
                    <div>Dark</div>
                </div>
            </div>
            
            <div class="settings-group">
                <label class="settings-label">Glass Effect</label>
                <div class="glass-controls">
                    <div class="glass-control">
                        <label for="blurSlider">Blur Intensity</label>
                        <input type="range" min="0" max="30" value="16" class="glass-slider" id="blurSlider">
                    </div>
                    <div class="glass-control">
                        <label for="glowSlider">Glow Intensity</label>
                        <input type="range" min="0" max="100" value="20" class="glass-slider" id="glowSlider">
                    </div>
                </div>
            </div>
            
            <div class="settings-group">
                <label class="settings-label">Accent Color</label>
                <div class="color-options">
                    <label class="color-option">
                        <input type="radio" name="accentColor" value="purple" checked>
                        <span class="color-box purple"></span>
                        <span class="color-name">Purple</span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="accentColor" value="blue">
                        <span class="color-box blue"></span>
                        <span class="color-name">Blue</span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="accentColor" value="green">
                        <span class="color-box green"></span>
                        <span class="color-name">Green</span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="accentColor" value="red">
                        <span class="color-box red"></span>
                        <span class="color-name">Red</span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="accentColor" value="pink">
                        <span class="color-box pink"></span>
                        <span class="color-name">Pink</span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="accentColor" value="orange">
                        <span class="color-box orange"></span>
                        <span class="color-name">Orange</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="settings-group">
            <label class="settings-label">Task Settings</label>
            <div class="toggle-group">
                <span class="toggle-label">Show task dates</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="showDatesToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-group">
                <span class="toggle-label">Confirm before delete</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="confirmDeleteToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-group">
                <span class="toggle-label">Enable notifications</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="enableNotificationsToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-group">
                <span class="toggle-label">Show priority indicators</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="showPriorityIndicatorsToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-group">
                <span class="toggle-label">Auto-sort tasks</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="autoSortToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-group">
                <span class="toggle-label">Task animations</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="showAnimationsToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="settings-group">
            <label class="settings-label">Data Management</label>
            <button class="data-btn" id="exportBtn">
                <i class="fas fa-file-export"></i>
                Export Tasks (JSON)
            </button>
            <button class="data-btn" id="importBtn">
                <i class="fas fa-file-import"></i>
                Import Tasks (JSON)
            </button>
            <input type="file" id="file-input" accept=".json">
            <button class="data-btn" id="clearAllBtn" style="color: var(--danger);">
                <i class="fas fa-trash"></i>
                Clear All Tasks
            </button>
        </div>

        <div class="settings-group">
            <label class="settings-label">Categories</label>
            <div id="categoriesList" style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                <!-- Categories will be listed here -->
            </div>
            <div style="display: flex; gap: 0.5rem;">
                <input type="text" id="newCategoryInput" placeholder="New category name" style="flex: 1; padding: 0.75rem; border-radius: 8px; border: 1px solid var(--border); background: rgba(255, 255, 255, 0.1); color: var(--text);">
                <button id="addCategorySettingsBtn" style="padding: 0.75rem 1rem; border-radius: 8px; border: none; background: var(--primary); color: white; cursor: pointer;">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>

        <div class="settings-group">
            <label class="settings-label">Advanced</label>
            <button class="data-btn" id="resetSettingsBtn" style="color: var(--danger);">
                <i class="fas fa-undo"></i>
                Reset All Settings
            </button>
        </div>

        <div class="settings-group">
            <label class="settings-label">About</label>
            <p style="color: var(--text); opacity: 0.7; font-size: 0.875rem; margin-bottom: 1rem;">
                Nova Glass v2.1<br>
                Ultimate Glassmorphic Task Manager<br><br>
                Features added:<br>
                - Task notes<br>
                - Category management<br>
                - Enhanced editing<br>
                - Glass effect controls<br>
                - Improved design
            </p>
        </div>
    </div>

    <script>
        // ====== DOM ELEMENTS ======
        const mainAddBtn = document.getElementById('mainAddBtn');
        const addWindow = document.getElementById('addWindow');
        const closeAddWindow = document.getElementById('closeAddWindow');
        const addTaskForm = document.getElementById('addTaskForm');
        const addTaskTitle = document.getElementById('addTaskTitle');
        const addTaskDescription = document.getElementById('addTaskDescription');
        const addTaskPriority = document.querySelector('input[name="addTaskPriority"]:checked');
        const addTaskDue = document.getElementById('addTaskDue');
        const addTaskCategory = document.getElementById('addTaskCategory');
        const addTaskLocation = document.getElementById('addTaskLocation');
        const addCategoryBtn = document.getElementById('addCategoryBtn');
        const removeCategoryBtn = document.getElementById('removeCategoryBtn');
        
        const editWindow = document.getElementById('editWindow');
        const closeEditWindow = document.getElementById('closeEditWindow');
        const editTaskForm = document.getElementById('editTaskForm');
        const editTaskId = document.getElementById('editTaskId');
        const editTaskTitle = document.getElementById('editTaskTitle');
        const editTaskDescription = document.getElementById('editTaskDescription');
        const editTaskPriority = document.querySelector('input[name="editTaskPriority"]:checked');
        const editTaskDue = document.getElementById('editTaskDue');
        const editTaskCategory = document.getElementById('editTaskCategory');
        const editTaskLocation = document.getElementById('editTaskLocation');
        
        const noteWindow = document.getElementById('noteWindow');
        const closeNoteWindow = document.getElementById('closeNoteWindow');
        const noteForm = document.getElementById('noteForm');
        const noteTaskId = document.getElementById('noteTaskId');
        const noteContent = document.getElementById('noteContent');
        
        const taskList = document.getElementById('taskList');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const priorityBtns = document.querySelectorAll('.priority-btn');
        const statsText = document.getElementById('statsText');
        const clearCompleted = document.getElementById('clearCompleted');
        
        const themeToggle = document.getElementById('themeToggle');
        const settingsBtn = document.getElementById('settingsBtn');
        const settingsPanel = document.getElementById('settingsPanel');
        const closeSettings = document.getElementById('closeSettings');
        
        const exportBtn = document.getElementById('exportBtn');
        const importBtn = document.getElementById('importBtn');
        const fileInput = document.getElementById('file-input');
        const clearAllBtn = document.getElementById('clearAllBtn');
        const resetSettingsBtn = document.getElementById('resetSettingsBtn');
        
        const themeOptions = document.querySelectorAll('.theme-option');
        const showDatesToggle = document.getElementById('showDatesToggle');
        const confirmDeleteToggle = document.getElementById('confirmDeleteToggle');
        const enableNotificationsToggle = document.getElementById('enableNotificationsToggle');
        const showPriorityIndicatorsToggle = document.getElementById('showPriorityIndicatorsToggle');
        const autoSortToggle = document.getElementById('autoSortToggle');
        const showAnimationsToggle = document.getElementById('showAnimationsToggle');
        const accentColor = document.querySelector('input[name="accentColor"]:checked');
        
        const searchInput = document.getElementById('searchInput');
        const notificationContainer = document.getElementById('notificationContainer');
        const overlay = document.getElementById('overlay');
        
        const categoriesList = document.getElementById('categoriesList');
        const newCategoryInput = document.getElementById('newCategoryInput');
        const addCategorySettingsBtn = document.getElementById('addCategorySettingsBtn');

        // Glass effect controls
        const blurSlider = document.getElementById('blurSlider');
        const glowSlider = document.getElementById('glowSlider');

        // Confirmation dialog elements
        const confirmationDialog = document.getElementById('confirmationDialog');
        const confirmationTitle = document.getElementById('confirmationTitle');
        const confirmationMessage = document.getElementById('confirmationMessage');
        const confirmationCancel = document.getElementById('confirmationCancel');
        const confirmationConfirm = document.getElementById('confirmationConfirm');

        // Date Picker Elements
        const datePickerBtn = document.getElementById('datePickerBtn');
        const calendarPopup = document.getElementById('calendarPopup');
        const calendarMonthYear = document.querySelector('.calendar-month-year');
        const calendarDays = document.getElementById('calendarDays');
        const prevMonthBtn = document.querySelector('.prev-month');
        const nextMonthBtn = document.querySelector('.next-month');
        const todayBtn = document.querySelector('.calendar-today-btn');
        const clearBtn = document.querySelector('.calendar-clear-btn');

        const editDatePickerBtn = document.getElementById('editDatePickerBtn');
        const editCalendarPopup = document.getElementById('editCalendarPopup');
        const editCalendarMonthYear = document.querySelector('#editCalendarPopup .calendar-month-year');
        const editCalendarDays = document.getElementById('editCalendarDays');
        const editPrevMonthBtn = document.querySelector('#editCalendarPopup .prev-month');
        const editNextMonthBtn = document.querySelector('#editCalendarPopup .next-month');
        const editTodayBtn = document.querySelector('#editCalendarPopup .calendar-today-btn');
        const editClearBtn = document.querySelector('#editCalendarPopup .calendar-clear-btn');

        // ====== APP STATE ======
        let tasks = JSON.parse(localStorage.getItem('nova-tasks')) || [];
        let categories = JSON.parse(localStorage.getItem('nova-categories')) || ['Work', 'Personal', 'Study', 'Home'];
        let currentFilter = 'all';
        let currentPriority = 'all';
        let currentSearch = '';
        let settings = JSON.parse(localStorage.getItem('nova-settings')) || {
            theme: 'system',
            showDates: false,
            confirmDelete: true,
            enableNotifications: false,
            showPriorityIndicators: true,
            autoSort: true,
            showAnimations: true,
            blurIntensity: 16,
            glowIntensity: 20,
            accentColor: 'purple'
        };

        // Calendar state
        let currentDate = new Date();
        let selectedDate = null;
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();

        // Confirmation dialog state
        let confirmationCallback = null;

        // ====== INITIALIZE APP ======
        function init() {
            loadSettings();
            renderTasks();
            updateStats();
            renderCategories();
            setupEventListeners();
            initDatePicker();
            initEditDatePicker();
            
            // Request notification permission if enabled
            if (settings.enableNotifications && Notification.permission !== 'denied') {
                Notification.requestPermission();
            }
            
            // Apply glass intensity
            applyGlassIntensity();
        }

        // ====== DATE PICKER FUNCTIONS ======
        function initDatePicker() {
            datePickerBtn.addEventListener('click', toggleCalendar);
            prevMonthBtn.addEventListener('click', () => {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderCalendar();
            });
            nextMonthBtn.addEventListener('click', () => {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar();
            });
            todayBtn.addEventListener('click', () => {
                const today = new Date();
                currentMonth = today.getMonth();
                currentYear = today.getFullYear();
                selectedDate = today;
                addTaskDue.value = formatDate(today);
                renderCalendar();
                toggleCalendar();
            });
            clearBtn.addEventListener('click', () => {
                selectedDate = null;
                addTaskDue.value = '';
                toggleCalendar();
            });
            renderCalendar();
        }

        function initEditDatePicker() {
            editDatePickerBtn.addEventListener('click', toggleEditCalendar);
            editPrevMonthBtn.addEventListener('click', () => {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderEditCalendar();
            });
            editNextMonthBtn.addEventListener('click', () => {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderEditCalendar();
            });
            editTodayBtn.addEventListener('click', () => {
                const today = new Date();
                currentMonth = today.getMonth();
                currentYear = today.getFullYear();
                selectedDate = today;
                editTaskDue.value = formatDate(today);
                renderEditCalendar();
                toggleEditCalendar();
            });
            editClearBtn.addEventListener('click', () => {
                selectedDate = null;
                editTaskDue.value = '';
                toggleEditCalendar();
            });
            renderEditCalendar();
        }

        function toggleCalendar() {
            calendarPopup.classList.toggle('show');
        }

        function toggleEditCalendar() {
            editCalendarPopup.classList.toggle('show');
        }

        function renderCalendar() {
            calendarMonthYear.textContent = new Date(currentYear, currentMonth).toLocaleDateString('en-US', {
                month: 'long',
                year: 'numeric'
            });

            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();

            calendarDays.innerHTML = '';

            // Previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = document.createElement('div');
                day.className = 'calendar-day other-month';
                day.textContent = daysInPrevMonth - i;
                calendarDays.appendChild(day);
            }

            // Current month days
            const today = new Date();
            for (let i = 1; i <= daysInMonth; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                day.textContent = i;

                // Highlight today
                if (i === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) {
                    day.classList.add('today');
                }

                // Highlight selected date
                if (selectedDate && i === selectedDate.getDate() && currentMonth === selectedDate.getMonth() && currentYear === selectedDate.getFullYear()) {
                    day.classList.add('selected');
                }

                day.addEventListener('click', () => {
                    selectedDate = new Date(currentYear, currentMonth, i);
                    addTaskDue.value = formatDate(selectedDate);
                    renderCalendar();
                    toggleCalendar();
                });

                calendarDays.appendChild(day);
            }

            // Next month days
            const totalDays = firstDay + daysInMonth;
            const nextMonthDays = totalDays <= 35 ? 35 - totalDays : 42 - totalDays;
            for (let i = 1; i <= nextMonthDays; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day other-month';
                day.textContent = i;
                calendarDays.appendChild(day);
            }
        }

        function renderEditCalendar() {
            editCalendarMonthYear.textContent = new Date(currentYear, currentMonth).toLocaleDateString('en-US', {
                month: 'long',
                year: 'numeric'
            });

            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();

            editCalendarDays.innerHTML = '';

            // Previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = document.createElement('div');
                day.className = 'calendar-day other-month';
                day.textContent = daysInPrevMonth - i;
                editCalendarDays.appendChild(day);
            }

            // Current month days
            const today = new Date();
            for (let i = 1; i <= daysInMonth; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                day.textContent = i;

                // Highlight today
                if (i === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) {
                    day.classList.add('today');
                }

                // Highlight selected date
                if (selectedDate && i === selectedDate.getDate() && currentMonth === selectedDate.getMonth() && currentYear === selectedDate.getFullYear()) {
                    day.classList.add('selected');
                }

                day.addEventListener('click', () => {
                    selectedDate = new Date(currentYear, currentMonth, i);
                    editTaskDue.value = formatDate(selectedDate);
                    renderEditCalendar();
                    toggleEditCalendar();
                });

                editCalendarDays.appendChild(day);
            }

            // Next month days
            const totalDays = firstDay + daysInMonth;
            const nextMonthDays = totalDays <= 35 ? 35 - totalDays : 42 - totalDays;
            for (let i = 1; i <= nextMonthDays; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day other-month';
                day.textContent = i;
                editCalendarDays.appendChild(day);
            }
        }

        function formatDate(date) {
            if (!date) return '';
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // ====== TASK MANAGEMENT ======
        function renderTasks() {
            taskList.innerHTML = '';

            const filteredTasks = tasks.filter(task => {
                // Filter by completion status
                if (currentFilter === 'active' && task.completed) return false;
                if (currentFilter === 'completed' && !task.completed) return false;
                if (currentFilter === 'pinned' && !task.pinned) return false;
                
                // Filter by date
                if (currentFilter === 'today') {
                    const today = new Date().toISOString().split('T')[0];
                    if (task.dueDate !== today) return false;
                }
                
                if (currentFilter === 'upcoming') {
                    const today = new Date();
                    const taskDate = new Date(task.dueDate);
                    if (!task.dueDate || taskDate < today) return false;
                }
                
                // Filter by priority
                if (currentPriority !== 'all' && task.priority !== currentPriority) return false;
                
                // Filter by search
                if (currentSearch && 
                    !task.text.toLowerCase().includes(currentSearch.toLowerCase()) &&
                    !(task.description && task.description.toLowerCase().includes(currentSearch.toLowerCase())) &&
                    !(task.location && task.location.toLowerCase().includes(currentSearch.toLowerCase())) &&
                    !(task.note && task.note.toLowerCase().includes(currentSearch.toLowerCase()))) {
                    return false;
                }
                
                return true;
            });

            if (filteredTasks.length === 0) {
                taskList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">📋</div>
                        <p>No tasks found</p>
                        <p>${currentFilter === 'all' ? 'Add your first task!' : 'No tasks match your filters'}</p>
                    </div>
                `;
                return;
            }

            // Sort tasks if auto-sort is enabled
            if (settings.autoSort) {
                filteredTasks.sort((a, b) => {
                    // Pinned tasks first
                    if (a.pinned && !b.pinned) return -1;
                    if (!a.pinned && b.pinned) return 1;
                    
                    // Then by priority (high first)
                    const priorityOrder = { high: 1, medium: 2, low: 3 };
                    if (priorityOrder[a.priority] < priorityOrder[b.priority]) return -1;
                    if (priorityOrder[a.priority] > priorityOrder[b.priority]) return 1;
                    
                    // Then by due date (earlier first)
                    if (a.dueDate && b.dueDate) {
                        return new Date(a.dueDate) - new Date(b.dueDate);
                    }
                    if (a.dueDate && !b.dueDate) return -1;
                    if (!a.dueDate && b.dueDate) return 1;
                    
                    // Then by creation date (newer first)
                    return new Date(b.createdAt) - new Date(a.createdAt);
                });
            }

            filteredTasks.forEach((task, index) => {
                const taskItem = document.createElement('li');
                taskItem.className = `task-item ${task.completed ? 'completed' : ''} ${task.pinned ? 'pinned' : ''} ${settings.showAnimations ? 'task-animation' : ''}`;
                taskItem.dataset.id = task.id;
                
                // Only add animation delay if animations are enabled
                if (settings.showAnimations) {
                    taskItem.style.animationDelay = `${index * 0.05}s`;
                }
                
                const dateString = task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '';
                const priorityClass = `priority-${task.priority}`;
                
                taskItem.innerHTML = `
                    <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''}>
                    <div class="task-content">
                        <span class="task-text ${task.completed ? 'completed' : ''}">${task.text}</span>
                        ${task.description ? `<p class="task-description">${task.description}</p>` : ''}
                        <div class="task-meta">
                            ${settings.showDates && dateString ? `
                                <span class="task-date">
                                    <i class="far fa-calendar-alt"></i> ${dateString}
                                </span>
                            ` : ''}
                            ${settings.showPriorityIndicators ? `
                                <span class="task-priority ${priorityClass}">
                                    <i class="fas fa-bolt"></i> ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                                </span>
                            ` : ''}
                            ${task.category ? `
                                <span class="task-category">
                                    <i class="fas fa-tag"></i> ${task.category}
                                </span>
                            ` : ''}
                            ${task.location ? `
                                <span class="task-location">
                                    <i class="fas fa-map-marker-alt"></i> ${task.location}
                                </span>
                            ` : ''}
                            ${task.note ? `
                                <span class="task-note">
                                    <i class="fas fa-sticky-note"></i> Note
                                </span>
                            ` : ''}
                        </div>
                    </div>
                    <div class="task-actions">
                        <button class="task-btn edit" title="Edit"><i class="fas fa-edit"></i></button>
                        ${task.note ? `
                            <button class="task-btn note" title="View Note">
                                <i class="fas fa-sticky-note"></i>
                            </button>
                        ` : ''}
                        <button class="task-btn pin" title="${task.pinned ? 'Unpin' : 'Pin'}">
                            <i class="fas fa-thumbtack"></i>
                        </button>
                        <button class="task-btn delete" title="Delete"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                
                taskList.appendChild(taskItem);
            });

            // Add event listeners to all task elements
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', toggleTask);
            });

            document.querySelectorAll('.task-btn.delete').forEach(btn => {
                btn.addEventListener('click', deleteTask);
            });

            document.querySelectorAll('.task-btn.edit').forEach(btn => {
                btn.addEventListener('click', () => openEditModal(parseInt(btn.closest('.task-item').dataset.id)));
            });

            document.querySelectorAll('.task-btn.pin').forEach(btn => {
                btn.addEventListener('click', () => togglePinTask(parseInt(btn.closest('.task-item').dataset.id)));
            });
            
            document.querySelectorAll('.task-btn.note').forEach(btn => {
                btn.addEventListener('click', () => openNoteModal(parseInt(btn.closest('.task-item').dataset.id)));
            });
        }

        function addTask(e) {
            e.preventDefault();
            
            const text = addTaskTitle.value.trim();
            if (text) {
                const priority = document.querySelector('input[name="addTaskPriority"]:checked').value;
                
                const newTask = {
                    id: Date.now(),
                    text,
                    description: addTaskDescription.value.trim(),
                    completed: false,
                    priority: priority,
                    category: addTaskCategory.value || null,
                    location: addTaskLocation.value.trim() || null,
                    dueDate: addTaskDue.value || null,
                    pinned: false,
                    createdAt: new Date().toISOString(),
                    note: null
                };
                
                tasks.push(newTask);
                addTaskForm.reset();
                // Reset priority to medium
                document.getElementById('addPriorityMedium').checked = true;
                addTaskDue.value = new Date().toISOString().split('T')[0]; // Reset to today
                toggleAddWindow();
                saveAndRender();
                showNotification('Task added!', 'success');
                
                // Show notification if enabled
                if (settings.enableNotifications && Notification.permission === 'granted') {
                    new Notification('Task Added', {
                        body: text,
                        icon: '/favicon.ico'
                    });
                }
            }
        }

        function toggleTask(e) {
            const taskId = parseInt(e.target.closest('.task-item').dataset.id);
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveAndRender();
                showNotification(`Task ${task.completed ? 'completed!' : 'reactivated'}`, 'success');
                
                // Show notification if enabled
                if (settings.enableNotifications && Notification.permission === 'granted') {
                    new Notification(`Task ${task.completed ? 'Completed' : 'Reactivated'}`, {
                        body: task.text,
                        icon: '/favicon.ico'
                    });
                }
            }
        }

        function deleteTask(e) {
            const taskId = parseInt(e.target.closest('.task-item').dataset.id);
            const task = tasks.find(t => t.id === taskId);
            
            if (settings.confirmDelete) {
                showConfirmation(
                    'Delete Task', 
                    `Are you sure you want to delete task: "${task.text}"?`,
                    () => {
                        tasks = tasks.filter(t => t.id !== taskId);
                        saveAndRender();
                        showNotification('Task deleted!', 'error');
                    }
                );
            } else {
                tasks = tasks.filter(t => t.id !== taskId);
                saveAndRender();
                showNotification('Task deleted!', 'error');
            }
        }

        function togglePinTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.pinned = !task.pinned;
                saveAndRender();
                showNotification(`Task ${task.pinned ? 'pinned!' : 'unpinned'}`, 'success');
            }
        }

        function clearCompletedTasks() {
            const completedTasks = tasks.filter(t => t.completed);
            if (completedTasks.length === 0) {
                showNotification('No completed tasks to clear!', 'warning');
                return;
            }
            
            showConfirmation(
                'Clear Completed Tasks', 
                `Clear ${completedTasks.length} completed task${completedTasks.length !== 1 ? 's' : ''}?`,
                () => {
                    tasks = tasks.filter(t => !t.completed);
                    saveAndRender();
                    showNotification('Completed tasks cleared!', 'success');
                }
            );
        }

        function clearAllTasks() {
            if (tasks.length === 0) {
                showNotification('No tasks to clear!', 'warning');
                return;
            }
            
            showConfirmation(
                'Clear All Tasks', 
                'Are you sure you want to delete ALL tasks? This cannot be undone.',
                () => {
                    tasks = [];
                    saveAndRender();
                    showNotification('All tasks cleared!', 'success');
                }
            );
        }

        function updateStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const pinned = tasks.filter(t => t.pinned).length;
            const today = new Date().toISOString().split('T')[0];
            const dueToday = tasks.filter(t => t.dueDate === today && !t.completed).length;
            
            statsText.textContent = `${total} task${total !== 1 ? 's' : ''} (${completed} completed, ${pinned} pinned, ${dueToday} due today)`;
        }

        // ====== EDIT FUNCTIONALITY ======
        function openEditModal(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                editTaskId.value = task.id;
                editTaskTitle.value = task.text;
                editTaskDescription.value = task.description || '';
                document.querySelector(`#editPriority${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}`).checked = true;
                editTaskDue.value = task.dueDate || '';
                
                // Populate categories in edit modal
                editTaskCategory.innerHTML = '';
                const emptyOption = document.createElement('option');
                emptyOption.value = '';
                emptyOption.textContent = 'No Category';
                editTaskCategory.appendChild(emptyOption);
                
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    if (category === task.category) {
                        option.selected = true;
                    }
                    editTaskCategory.appendChild(option);
                });
                
                editTaskLocation.value = task.location || '';
                
                toggleOverlay(true);
                editWindow.classList.add('active');
            }
        }

        function saveEditedTask(e) {
            e.preventDefault();
            
            const taskId = parseInt(editTaskId.value);
            const task = tasks.find(t => t.id === taskId);
            
            if (task) {
                task.text = editTaskTitle.value.trim();
                task.description = editTaskDescription.value.trim();
                task.priority = document.querySelector('input[name="editTaskPriority"]:checked').value;
                task.category = editTaskCategory.value || null;
                task.location = editTaskLocation.value.trim() || null;
                task.dueDate = editTaskDue.value || null;
                
                saveAndRender();
                closeEditModal();
                showNotification('Task updated!', 'success');
            }
        }

        function closeEditModal() {
            editWindow.classList.remove('active');
            toggleOverlay(false);
        }

        // ====== NOTE FUNCTIONALITY ======
        function openNoteModal(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                noteTaskId.value = task.id;
                noteContent.value = task.note || '';
                
                toggleOverlay(true);
                noteWindow.classList.add('active');
            }
        }

        function saveNote(e) {
            e.preventDefault();
            
            const taskId = parseInt(noteTaskId.value);
            const task = tasks.find(t => t.id === taskId);
            
            if (task) {
                task.note = noteContent.value.trim() || null;
                
                saveAndRender();
                closeNoteModal();
                showNotification('Note saved!', 'success');
            }
        }

        function closeNoteModal() {
            noteWindow.classList.remove('active');
            toggleOverlay(false);
        }

        // ====== OVERLAY FUNCTIONALITY ======
        function toggleOverlay(show) {
            if (show) {
                overlay.classList.add('active');
            } else {
                overlay.classList.remove('active');
            }
        }

        // ====== CATEGORY MANAGEMENT ======
        function renderCategories() {
            // Clear and repopulate category dropdowns
            addTaskCategory.innerHTML = '';
            editTaskCategory.innerHTML = '';
            
            // Add empty option
            const emptyOption = document.createElement('option');
            emptyOption.value = '';
            emptyOption.textContent = 'No Category';
            addTaskCategory.appendChild(emptyOption.cloneNode(true));
            editTaskCategory.appendChild(emptyOption.cloneNode(true));
            
            // Add all categories
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                addTaskCategory.appendChild(option.cloneNode(true));
                editTaskCategory.appendChild(option.cloneNode(true));
            });
            
            // Render categories in settings panel
            renderCategoriesList();
        }

        function renderCategoriesList() {
            categoriesList.innerHTML = '';
            
            categories.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.style.display = 'flex';
                categoryItem.style.alignItems = 'center';
                categoryItem.style.gap = '0.5rem';
                categoryItem.style.padding = '0.5rem';
                categoryItem.style.background = 'rgba(0, 0, 0, 0.1)';
                categoryItem.style.borderRadius = '8px';
                
                categoryItem.innerHTML = `
                    <span>${category}</span>
                    <button class="delete-category-btn" data-category="${category}" style="background: none; border: none; color: var(--danger); cursor: pointer;">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                categoriesList.appendChild(categoryItem);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-category-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const category = btn.dataset.category;
                    removeCategory(category);
                });
            });
        }

        function addCategory() {
            const currentCategory = addTaskCategory.value.trim();
            const newCategory = prompt('Enter new category name:', currentCategory);
            
            if (newCategory && !categories.includes(newCategory)) {
                categories.push(newCategory);
                localStorage.setItem('nova-categories', JSON.stringify(categories));
                renderCategories();
                showNotification('Category added!', 'success');
                
                // Select the new category
                addTaskCategory.value = newCategory;
            }
        }

        function removeCategory(categoryToRemove) {
            if (!categories.includes(categoryToRemove)) return;
            
            // Check if any tasks use this category
            const tasksWithCategory = tasks.filter(t => t.category === categoryToRemove);
            
            if (tasksWithCategory.length > 0) {
                showConfirmation(
                    'Remove Category', 
                    `This category is used by ${tasksWithCategory.length} task(s). Remove anyway? Tasks will keep the category but it won't be available for new tasks.`,
                    () => {
                        categories = categories.filter(c => c !== categoryToRemove);
                        localStorage.setItem('nova-categories', JSON.stringify(categories));
                        renderCategories();
                        showNotification('Category removed!', 'success');
                    }
                );
            } else {
                categories = categories.filter(c => c !== categoryToRemove);
                localStorage.setItem('nova-categories', JSON.stringify(categories));
                renderCategories();
                showNotification('Category removed!', 'success');
            }
        }

        function addCategoryFromSettings() {
            const newCategory = newCategoryInput.value.trim();
            
            if (newCategory && !categories.includes(newCategory)) {
                categories.push(newCategory);
                localStorage.setItem('nova-categories', JSON.stringify(categories));
                renderCategories();
                showNotification('Category added!', 'success');
                newCategoryInput.value = '';
            } else if (categories.includes(newCategory)) {
                showNotification('Category already exists!', 'warning');
            }
        }

        // ====== FILTERING ======
        function applyFilter(filter) {
            currentFilter = filter;
            renderTasks();
        }

        function applyPriorityFilter(priority) {
            currentPriority = priority;
            renderTasks();
        }

        function applySearch(searchTerm) {
            currentSearch = searchTerm;
            renderTasks();
        }

        // ====== THEME MANAGEMENT ======
        function applyTheme(theme) {
            if (theme === 'system') {
                document.documentElement.removeAttribute('data-theme');
                settings.theme = 'system';
                updateThemeToggleIcons();
            } else {
                document.documentElement.setAttribute('data-theme', theme);
                settings.theme = theme;
                updateThemeToggleIcons();
            }
            saveSettings();
        }

        function updateThemeToggleIcons() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark' || 
                          (document.documentElement.getAttribute('data-theme') === null && 
                           window.matchMedia('(prefers-color-scheme: dark)').matches);
            
            document.documentElement.style.setProperty('--light-theme-icon-opacity', isDark ? '0' : '1');
            document.documentElement.style.setProperty('--light-theme-icon-transform', isDark ? 'scale(0.5)' : 'scale(1)');
            document.documentElement.style.setProperty('--dark-theme-icon-opacity', isDark ? '1' : '0');
            document.documentElement.style.setProperty('--dark-theme-icon-transform', isDark ? 'scale(1)' : 'scale(0.5)');
        }

        function applyGlassIntensity() {
            document.documentElement.style.setProperty('--glass-blur', `blur(${settings.blurIntensity}px)`);
            document.documentElement.style.setProperty('--glass-highlight', `rgba(255, 255, 255, ${settings.glowIntensity/100})`);
        }

        // ====== SETTINGS MANAGEMENT ======
        function loadSettings() {
            // Set theme
            if (settings.theme === 'system') {
                document.documentElement.removeAttribute('data-theme');
            } else {
                document.documentElement.setAttribute('data-theme', settings.theme);
            }
            updateThemeToggleIcons();
            
            // Update theme selector
            themeOptions.forEach(option => {
                option.classList.remove('active');
                if (option.dataset.theme === settings.theme) {
                    option.classList.add('active');
                }
            });
            
            // Update toggles
            showDatesToggle.checked = settings.showDates;
            confirmDeleteToggle.checked = settings.confirmDelete;
            enableNotificationsToggle.checked = settings.enableNotifications;
            showPriorityIndicatorsToggle.checked = settings.showPriorityIndicators;
            autoSortToggle.checked = settings.autoSort;
            showAnimationsToggle.checked = settings.showAnimations;
            
            // Update glass effect controls
            blurSlider.value = settings.blurIntensity;
            glowSlider.value = settings.glowIntensity;
            
            // Update accent color
            document.querySelector(`input[name="accentColor"][value="${settings.accentColor}"]`).checked = true;
            
            // Apply accent color
            applyAccentColor();
        }

        function saveSettings() {
            settings = {
                theme: settings.theme,
                showDates: showDatesToggle.checked,
                confirmDelete: confirmDeleteToggle.checked,
                enableNotifications: enableNotificationsToggle.checked,
                showPriorityIndicators: showPriorityIndicatorsToggle.checked,
                autoSort: autoSortToggle.checked,
                showAnimations: showAnimationsToggle.checked,
                blurIntensity: parseInt(blurSlider.value),
                glowIntensity: parseInt(glowSlider.value),
                accentColor: document.querySelector('input[name="accentColor"]:checked').value
            };
            localStorage.setItem('nova-settings', JSON.stringify(settings));
            
            // Apply any visual changes
            applyGlassIntensity();
            applyAccentColor();
        }

        function applyAccentColor() {
            const color = document.querySelector('input[name="accentColor"]:checked').value;
            let primary, accent;
            
            switch(color) {
                case 'blue':
                    primary = '#2563eb';
                    accent = '#3b82f6';
                    break;
                case 'green':
                    primary = '#059669';
                    accent = '#10b981';
                    break;
                case 'red':
                    primary = '#dc2626';
                    accent = '#ef4444';
                    break;
                case 'pink':
                    primary = '#db2777';
                    accent = '#ec4899';
                    break;
                case 'orange':
                    primary = '#ea580c';
                    accent = '#f97316';
                    break;
                case 'purple':
                default:
                    primary = '#6d28d9';
                    accent = '#7c3aed';
            }
            
            document.documentElement.style.setProperty('--light-primary', primary);
            document.documentElement.style.setProperty('--light-accent', accent);
            document.documentElement.style.setProperty('--dark-primary', lightenColor(primary, 20));
            document.documentElement.style.setProperty('--dark-accent', lightenColor(accent, 20));
        }

        function lightenColor(color, percent) {
            const num = parseInt(color.replace('#', ''), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = (num >> 8 & 0x00FF) + amt;
            const B = (num & 0x0000FF) + amt;
            
            return '#' + (
                0x1000000 +
                (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                (B < 255 ? B < 1 ? 0 : B : 255)
            ).toString(16).slice(1);
        }

        function resetSettings() {
            showConfirmation(
                'Reset Settings', 
                'Are you sure you want to reset all settings to default?',
                () => {
                    settings = {
                        theme: 'system',
                        showDates: false,
                        confirmDelete: true,
                        enableNotifications: false,
                        showPriorityIndicators: true,
                        autoSort: true,
                        showAnimations: true,
                        blurIntensity: 16,
                        glowIntensity: 20,
                        accentColor: 'purple'
                    };
                    
                    saveSettings();
                    loadSettings();
                    showNotification('Settings reset to default!', 'success');
                }
            );
        }

        // ====== NOTIFICATION SYSTEM ======
        function showNotification(message, type = 'info', duration = 3000) {
            if (!settings.enableNotifications && type !== 'error') return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            let icon;
            switch(type) {
                case 'success':
                    icon = 'fas fa-check-circle';
                    break;
                case 'error':
                    icon = 'fas fa-exclamation-circle';
                    break;
                case 'warning':
                    icon = 'fas fa-exclamation-triangle';
                    break;
                default:
                    icon = 'fas fa-info-circle';
            }
            
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="${icon}"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${type.charAt(0).toUpperCase() + type.slice(1)}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <button class="notification-close">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            notificationContainer.appendChild(notification);
            
            // Trigger animation
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // Close button
            notification.querySelector('.notification-close').addEventListener('click', () => {
                closeNotification(notification);
            });
            
            // Auto-close
            if (duration > 0) {
                setTimeout(() => {
                    closeNotification(notification);
                }, duration);
            }
        }

        function closeNotification(notification) {
            notification.classList.remove('show');
            setTimeout(() => {
                notification.remove();
            }, 400);
        }

        // ====== CONFIRMATION DIALOG ======
        function showConfirmation(title, message, callback) {
            confirmationTitle.textContent = title;
            confirmationMessage.textContent = message;
            confirmationCallback = callback;
            
            toggleOverlay(true);
            confirmationDialog.classList.add('active');
        }

        function closeConfirmation() {
            confirmationDialog.classList.remove('active');
            toggleOverlay(false);
            confirmationCallback = null;
        }

        // ====== DATA IMPORT/EXPORT ======
        function exportTasks() {
            const data = {
                tasks: tasks,
                categories: categories,
                settings: settings,
                exportedAt: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `nova-tasks-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('Tasks exported!', 'success');
        }

        function importTasks(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        
                        if (!importedData.tasks || !Array.isArray(importedData.tasks)) {
                            showNotification('Invalid file format!', 'error');
                            return;
                        }
                        
                        showConfirmation(
                            'Import Tasks', 
                            `Import ${importedData.tasks.length} tasks? This will replace your current tasks.`,
                            () => {
                                tasks = importedData.tasks;
                                
                                // Import categories if available
                                if (importedData.categories && Array.isArray(importedData.categories)) {
                                    categories = importedData.categories;
                                    localStorage.setItem('nova-categories', JSON.stringify(categories));
                                    renderCategories();
                                }
                                
                                // Import settings if available
                                if (importedData.settings) {
                                    settings = importedData.settings;
                                    saveSettings();
                                    loadSettings();
                                }
                                
                                saveAndRender();
                                showNotification('Tasks imported!', 'success');
                            }
                        );
                    } catch (error) {
                        showNotification('Error importing tasks!', 'error');
                    }
                };
                reader.readAsText(file);
            }
            fileInput.value = '';
        }

        // ====== UTILITY FUNCTIONS ======
        function saveAndRender() {
            localStorage.setItem('nova-tasks', JSON.stringify(tasks));
            localStorage.setItem('nova-categories', JSON.stringify(categories));
            saveSettings();
            renderTasks();
            updateStats();
        }

        function toggleAddWindow() {
            addWindow.classList.toggle('active');
            toggleOverlay(addWindow.classList.contains('active'));
            
            if (addWindow.classList.contains('active')) {
                addTaskTitle.focus();
            }
        }

        function toggleSettingsPanel() {
            settingsPanel.classList.toggle('active');
            toggleOverlay(settingsPanel.classList.contains('active'));
        }

        // ====== EVENT LISTENERS ======
        function setupEventListeners() {
            // Floating add window
            mainAddBtn.addEventListener('click', toggleAddWindow);
            closeAddWindow.addEventListener('click', toggleAddWindow);
            addTaskForm.addEventListener('submit', addTask);
            
            // Edit window
            closeEditWindow.addEventListener('click', closeEditModal);
            editTaskForm.addEventListener('submit', saveEditedTask);
            
            // Note window
            closeNoteWindow.addEventListener('click', closeNoteModal);
            noteForm.addEventListener('submit', saveNote);
            
            // Confirmation dialog
            confirmationCancel.addEventListener('click', closeConfirmation);
            confirmationConfirm.addEventListener('click', () => {
                if (confirmationCallback) confirmationCallback();
                closeConfirmation();
            });
            
            // Overlay
            overlay.addEventListener('click', () => {
                addWindow.classList.remove('active');
                editWindow.classList.remove('active');
                noteWindow.classList.remove('active');
                settingsPanel.classList.remove('active');
                confirmationDialog.classList.remove('active');
                toggleOverlay(false);
            });
            
            // Filters
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    applyFilter(btn.dataset.filter);
                });
            });
            
            // Priority filters
            priorityBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    priorityBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    applyPriorityFilter(btn.dataset.priority);
                });
            });
            
            // Search
            searchInput.addEventListener('input', (e) => {
                applySearch(e.target.value);
            });
            
            // Clear completed
            clearCompleted.addEventListener('click', clearCompletedTasks);
            
            // Theme toggle
            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                if (currentTheme === 'dark' || (currentTheme === null && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    applyTheme('light');
                } else {
                    applyTheme('dark');
                }
            });
            
            // Settings panel
            settingsBtn.addEventListener('click', toggleSettingsPanel);
            closeSettings.addEventListener('click', toggleSettingsPanel);
            
            // Theme selection
            themeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    applyTheme(option.dataset.theme);
                    themeOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                });
            });
            
            // Settings toggles
            showDatesToggle.addEventListener('change', () => {
                settings.showDates = showDatesToggle.checked;
                saveSettings();
                renderTasks();
            });
            
            confirmDeleteToggle.addEventListener('change', () => {
                settings.confirmDelete = confirmDeleteToggle.checked;
                saveSettings();
            });
            
            enableNotificationsToggle.addEventListener('change', () => {
                settings.enableNotifications = enableNotificationsToggle.checked;
                saveSettings();
                
                // Request notification permission if enabled
                if (settings.enableNotifications && Notification.permission !== 'denied') {
                    Notification.requestPermission();
                }
            });
            
            showPriorityIndicatorsToggle.addEventListener('change', () => {
                settings.showPriorityIndicators = showPriorityIndicatorsToggle.checked;
                saveSettings();
                renderTasks();
            });
            
            autoSortToggle.addEventListener('change', () => {
                settings.autoSort = autoSortToggle.checked;
                saveSettings();
                renderTasks();
            });
            
            showAnimationsToggle.addEventListener('change', () => {
                settings.showAnimations = showAnimationsToggle.checked;
                saveSettings();
                renderTasks();
            });
            
            // Glass effect controls
            blurSlider.addEventListener('input', () => {
                settings.blurIntensity = parseInt(blurSlider.value);
                saveSettings();
            });
            
            glowSlider.addEventListener('input', () => {
                settings.glowIntensity = parseInt(glowSlider.value);
                saveSettings();
            });
            
            // Accent color change
            document.querySelectorAll('input[name="accentColor"]').forEach(input => {
                input.addEventListener('change', () => {
                    settings.accentColor = document.querySelector('input[name="accentColor"]:checked').value;
                    saveSettings();
                    applyAccentColor();
                });
            });
            
            // Category management
            addCategoryBtn.addEventListener('click', addCategory);
            removeCategoryBtn.addEventListener('click', () => {
                if (addTaskCategory.value) {
                    removeCategory(addTaskCategory.value);
                }
            });
            
            addCategorySettingsBtn.addEventListener('click', addCategoryFromSettings);
            newCategoryInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addCategoryFromSettings();
                }
            });
            
            // Data management
            exportBtn.addEventListener('click', exportTasks);
            importBtn.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', importTasks);
            clearAllBtn.addEventListener('click', clearAllTasks);
            resetSettingsBtn.addEventListener('click', resetSettings);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // Escape to close modals
                if (e.key === 'Escape') {
                    if (addWindow.classList.contains('active')) {
                        toggleAddWindow();
                    } else if (editWindow.classList.contains('active')) {
                        closeEditModal();
                    } else if (noteWindow.classList.contains('active')) {
                        closeNoteModal();
                    } else if (settingsPanel.classList.contains('active')) {
                        toggleSettingsPanel();
                    } else if (confirmationDialog.classList.contains('active')) {
                        closeConfirmation();
                    }
                }
            });
        }

        // Start the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            init();
        });
    </script>
</body>
</html>